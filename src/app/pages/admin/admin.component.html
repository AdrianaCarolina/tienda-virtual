<div class="d-flex justify-content-between align-items-center mb-3">
  <h4>Admin - Products</h4>
  <div>
    <button class="btn btn-success" (click)="openCreate()">Create Product</button>
  </div>
</div>

<div class="mb-3 d-flex gap-2 flex-column flex-md-row">
  <input class="form-control" placeholder="Search products by name..." [formControl]="search" />
  <select class="form-select" [formControl]="category" style="max-width: 260px">
    <option [ngValue]="null">All Categories</option>
    <option *ngFor="let c of categories$ | async" [value]="c.id">{{ c.name }}</option>
  </select>
</div>

<div *ngIf="showForm" class="mb-3">
  <div class="card p-3">
    <h5>{{ editing ? 'Edit Product' : 'Create Product' }}</h5>
    <app-product-form
      [product]="editing"
      [categories]="(categories$ | async) || []"
      (save)="onSave($event)"
      (cancel)="onCancel()"
    ></app-product-form>
  </div>
</div>

<div class="row g-3">
  <ng-container *ngIf="filtered$ | async as products">
    <div *ngIf="products.length === 0" class="text-muted">No products found.</div>
    <div *ngFor="let product of products" class="col-12 col-md-6 col-lg-4 d-flex">
      <div class="w-100">
        <app-product-card
          [product]="product"
          [categoryName]="'ID: ' + product.categoryId"
        ></app-product-card>
        <div class="mt-2 d-flex justify-content-between">
          <div>
            <button class="btn btn-outline-primary btn-sm me-2" (click)="openEdit(product)">
              Edit
            </button>
            <button class="btn btn-outline-danger btn-sm" (click)="onDelete(product.id)">
              Delete
            </button>
          </div>
          <div class="text-muted small align-self-center">ID: {{ product.id }}</div>
        </div>
      </div>
    </div>
  </ng-container>
</div>
